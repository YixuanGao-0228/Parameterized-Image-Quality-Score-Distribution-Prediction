%KL,correlation,cosine

function [JSD ,mse,chebyshev,Chi_Square,cosine]=KL0(x,score,co)
%x是横坐标取值，score是得分,co是分布的参数

nbins = 10;
%   x=[5,15,25,35,45,55,65,75,85,95];
%   co=[1.43851255378969,0.310646034074327,9.94612791935054,15.5399255296824];
%  score=[24.8000000000000;14;12.4000000000000;1;0;44.8000000000000;24.8000000000000;51.5782090000000;29.2000000000000;1;30.4000000000000;4;37.7321680000000;5.85298000000000;4.80000000000000;76.4781940000000;70.2019900000000;9.60000000000000;20;20.8000000000000;51.8750110000000;0;11.2000000000000;97.2000000000000;24.4000000000000;38.4000000000000;6.80000000000000;4;4.80000000000000;9.23363200000000;0;47.6000000000000;22;9.60000000000000;28.5000220000000;48.6376120000000;0;46.4811940000000;9.20000000000000;21.2205520000000;8.14582000000000;29.1367900000000;28;15.2000000000000;70.8000000000000;5.46618700000000;3.35719000000000;14;21.6000000000000;14.8000000000000;7.60000000000000;50.8000000000000;4.40000000000000;26.8000000000000;25.2000000000000;19.6000000000000;24.8000000000000;38;9.60000000000000;0;28;75.2000000000000;0;25.5000000000000;34.9500000000000;20.4500000000000;18.6500000000000;5.20000000000000;36.8000000000000;36.8000000000000;33.8500000000000;21.6000000000000;24.8000000000000;23.8500000000000;7.60000000000000;24.4000000000000;3.60000000000000;16.8000000000000;0;12.4000000000000;15.2000000000000;20.3000000000000;4;22;41.2000000000000;13.6000000000000;0;7.20000000000000;15.6000000000000;15.7500000000000;24.8000000000000;28.8000000000000;4.80000000000000;22.4000000000000;22.9500000000000;0;25.0500000000000;32.2000000000000;21.4500000000000;22.8000000000000;0;4.40000000000000;15.6500000000000;0;23.2000000000000;14.4000000000000;31.2000000000000;0;12.8000000000000;6.40000000000000;21.6000000000000;25.3500000000000;20.1500000000000;46.4000000000000;10.4000000000000;9.60000000000000;24.8000000000000;5.20000000000000;20.8000000000000;15.0500000000000;17.6000000000000;0;37.2000000000000;18.4000000000000;0;0;45.2000000000000;23.2000000000000;7.60000000000000;15.3500000000000;0;0;25.6000000000000;15.2000000000000;14;25.2500000000000;13.2000000000000;26;28.8000000000000;21.2000000000000;0;17.2000000000000;0;0;50.8000000000000;15.2000000000000;16.8000000000000;38.1500000000000;0;43.4500000000000;24;0;3.20000000000000;6.80000000000000;20;26.4000000000000;11.9000000000000;0;29.7500000000000;65.2000000000000;5.20000000000000;19.7500000000000;8];
data1 = score;  %第i张图像的评分列向量
  %% 画直方图

    h = histogram(data1,'Normalization','pdf','BinLimits',[0,100],'BinWidth',100/nbins,...
                  'FaceColor',[0.27451 0.5098 0.70588],'EdgeColor','w','LineWidth',1);  %直方图
   p1= h.Values;
   X=0:100;
p2=pdf('stable',X,co(1),co(2),co(3),co(4));
for j=1:10
z(j,:)=p2((j-1)*10+1:(j-1)*10+10);
p3(j)=(sum(z(j,:))/10);
end
p2=p3;

% h2 = histogram(p2','Normalization','probability','BinLimits',[0,100],'BinWidth',100/nbins,...
%                   'FaceColor',[0.27451 0.5098 0.70588],'EdgeColor','w','LineWidth',1);  %直方图
% p2= h2.Values;

for i=1:size(p1,2)
    if p1(i)==0
        p1(i)=0.0000000001;
    end
    if p2(i)==0
        p2(i)=0.0000000001;
    end
end

logQvect = log2((p2+p1)/2);
            kl = .5 * (sum(p1.*(log2(p1)-logQvect)) + ...
                sum(p2.*(log2(p2)-logQvect)));

JSD = JSDiv(p1,p2);
Y=[p1;p2];
spearman = abs(1-pdist(Y, 'Spearman'));
chebyshev = pdist(Y, 'chebychev');
err=p1-p2;
mse=sqrt(sum(err.^2)./nbins);%mse

cor=abs(1-pdist(Y,'correlation'));%Pearson 线性相关系数

cosine = 1- pdist(Y, 'cosine') ;



%标准欧几里德距离
seuclidean = pdist(Y, 'seuclidean');
%卡方
subMatrix = p1-p2;
subMatrix2 = subMatrix.^2;
addMatrix = p1+p2;

idxZero = find(addMatrix==0);
addMatrix(idxZero)=1;
DistMat = subMatrix2./addMatrix;

Chi_Square= sum(DistMat,2);  
%bhattacharyya
% bhat=bhattacharyya(p1,p2) ;

end
   